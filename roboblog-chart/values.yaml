# Default values for roboblog
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Image configuration for blog automation
image:
  repository: registry.gitlab.com/maluma/m42839360-cell.github.io
  pullPolicy: IfNotPresent
  tag: "v1.0.0"

# Secrets configuration
# IMPORTANT: Override these values in a separate values file (e.g., secrets.yaml)
# Never commit actual secrets to git!
secrets:
  enabled: true
  # GitHub Personal Access Token for fetching commits
  # Generate at: https://github.com/settings/tokens
  # Required scopes: repo (for private repos) or public_repo (for public only)
  githubToken: ""  # Set via --set secrets.githubToken=<token> or separate values file
  # Additional environment variables can be added here
  extra: {}
    # Example:
    # API_KEY: "your-api-key"

imagePullSecrets: [
  name: image-pull-secret
]
nameOverride: ""
fullnameOverride: ""

# PersistentVolumeClaim for shared _site directory
persistence:
  enabled: true
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 1Gi
  annotations: {}

# CronJob configuration for blog automation
# Runs: fetch commits -> generate posts -> build Jekyll site
cronjob:
  enabled: true
  schedule: "0 * * * *"  # Run automation every hour
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  concurrencyPolicy: Forbid
  restartPolicy: OnFailure
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi

# Nginx deployment for serving static files
nginx:
  replicaCount: 1
  image:
    repository: nginx
    tag: "1.25-alpine"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 200m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi
  # Custom nginx configuration (optional)
  config: |
    server {
      listen 80;
      server_name _;
      root /usr/share/nginx/html;
      index index.html;

      location / {
        try_files $uri $uri/ =404;
      }

      # Enable gzip compression
      gzip on;
      gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    }

# Service configuration
service:
  type: ClusterIP
  port: 80
  targetPort: 80
  annotations: {}

# Ingress configuration
ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: roboblog.example.com
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: roboblog-tls
  #    hosts:
  #      - roboblog.example.com

# Pod Security Context
podSecurityContext:
  fsGroup: 2000

# Container Security Context
securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Blog Automation Configuration
# These values populate the config.yml file mounted via ConfigMap
config:
  github:
    # Your GitHub username
    username: "maluio"
    # Repository filters (optional) - empty list means all repos
    repoFilters: []
    # Repositories to exclude from blog posts
    excludeRepos:
      - "maluio.github.io"  # Don't blog about the blog itself

  llm:
    # LLM provider: "openai", "anthropic", "ollama", or "openrouter"
    provider: "openai"
    # Environment variable name containing the API key
    apiKeyEnv: "LLM_API_KEY"
    # Model to use for generating blog posts
    # OpenAI: "gpt-4o-mini", "gpt-4o", "gpt-4", "gpt-3.5-turbo"
    # Anthropic: "claude-3-5-sonnet-20241022", "claude-3-opus-20240229"
    model: "gpt-5-mini"
    # Article style: "technical", "casual", "detailed", "concise", "tutorial", "story"
    articleStyle: "technical"
    # Maximum tokens for generation
    maxTokens: 16000
    # Temperature for creativity (0.0-1.0)
    temperature: 1.0

  automation:
    # Number of days to look back for commits
    lookbackDays: 7
    # Minimum commits required to generate a post
    minCommits: 1
    # Maximum commits to include in a single post
    maxCommits: 20
    # Post frequency (reference only)
    frequency: "weekly"

  blog:
    # Post title template
    # Available variables: {date}, {week}, {month}, {year}, {commit_count}
    titleTemplate: "Development Update - Week of {date}"
    # Include code snippets in posts
    includeCodeSnippets: true
    # Maximum length of code snippets (lines)
    maxSnippetLines: 20
    # Include commit statistics
    includeStats: true
    # Tags to automatically apply
    defaultTags:
      - "development"
      - "updates"
    # Author name for posts
    author: "Maluio"
